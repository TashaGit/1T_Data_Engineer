# Задание 4.5 Hive
```
Двигаемся дальше, и теперь на очереди — Hive!

Первым делом нужно достать данные — заходим и грузим все, что есть из репозитория: GitHub.

Эти файлы будут подвержены анализу, но в них кое-чего недостает — добавьте в каждый файл столбец с номером группы таким 
образом, чтобы файл был разделен на 10 групп. В файл customers.csv добавьте столбец с номером года, в который была 
совершена подписка (Subscription Date). Используйте средства python + pandas.

Загрузите полученные файлы на hdfs. 

Теперь ваша задача следующая: аналитики хотят сводную статистику на уровне каждой компании и на уровне каждого года 
получить целевую возрастную группу подписчиков — то есть, возрастную группу, представители которой чаще всего совершали 
подписку именно в текущий год на текущую компанию. 

Все операции необходимо выполнить в Hive. Работать с Hive можно через интерфейс HUE, если перейти в раздел «Query», или 
выбрав нужный пункт в разделе «Editor».

Таким образом вам нужно создать под каждый csv-файл отдельную таблицу. Для оптимизации используйте свои знания 
партиционирования и бакетирования. А затем на основе 3-х таблиц собрать витрину, которая решает поставленную задачу. 
В качестве результата предоставьте код SQL-запросов для создания исходных таблиц и создания итоговой витрины.

Результат выполнения задания необходимо выложить в github/gitlab и указать ссылку на Ваш репозиторий 
(не забудьте: репозиторий должен быть публичным).
```
### Необходимо скачать на компьютер все файлы и папки из репозитория по ссылке: https://github.com/mazavlia/1T_Data_Engineer/tree/main/Theme_4_6_Scala

## Описание проекта.

### В результате выполнения этого проекта были созданы 2 файла с расширением .scala:

1. [scala_intro.scala](./Scala_intro/src/main/scala/scala_intro.scala)

2. [scala_new.scala](./Scala_intro/src/main/scala/scala_new.scala)

### 1. Файл [scala_intro.scala](./Scala_intro/src/main/scala/scala_intro.scala) реализует логику из задания 2 и 3 'a'.

#### Собранный файл .jar: ```./Scala_intro/Scala_intro.jar```

Для запуска программы необходимо в командной строке перейти в папку [./Scala_intro/](./Scala_intro/), где лежит файл, и выполнить команду:

```java -jar Scala_intro.jar```

### Работа программы в терминале отражена на картинке:
![jar.png](./pictures/jar.png)

### 2. Файл [scala_new.scala](./Scala_intro/src/main/scala/scala_new.scala) реализует логику из заданий 3 'b' - 3 'h'.

Программа, написанная в файле scala_new.scala на языке Scala состоит из восьми объектов и предназначена для выполнения различных задач, связанных с расчетом зарплат и анализом зарплатных данных сотрудников. 

Рассмотрим каждый объект подробнее.

+ **object Main:**

    Главный объект программы, управляющий исполнением всех других объектов. Он последовательно вызывает функции main из каждого из следующих объектов.

+ **object SalaryCalculator (Задача 3 'b'):**

    Рассчитывает месячный доход сотрудника после вычета налогов, учитывая годовой доход, процент премии и компенсацию за питание.

    Программа запрашивает у пользователя значения годового дохода сотрудника до вычета налогов, процент премии и сумму компенсации за питание.

    После этого программа рассчитывает премию в денежном выражении, вычисляет налог (НДФЛ 13%) и печатает сумму ежемесячного заработка за минусом налогов. 

+ **object SalaryDeviationCalculator (Задача 3 'c'):**
    
    Вычисляет отклонение зарплаты каждого сотрудника от среднего значения зарплат по отделу в процентах.
    
    Расчет производится автоматически.

+ **object AdjustedSalaryCalculator (Задача 3 'd'):** 

    На основе отклонения зарплаты последнего сотрудника от среднего уровня, рассчитывает его измененную зарплату и находит минимальную и максимальную зарплаты в отделе.

    Расчет производится автоматически.

+ **object SalarySortedList (Задача 3 'e'):**

    Обновляет список зарплат новыми значениями и сортирует его по возрастанию.

    Расчет производится автоматически.

+ **object EmployeeRanking  (Задача 3 'f'):**

    Присваивает порядковый номер новому сотруднику в обновленном отсортированном списке зарплат в зависимости от его зарплаты и выводит весь обновленный список.

    Расчет производится автоматически.

+ **object MiddleLevelEmployees (Задача 3 'g'):**

    Определяет и выводит список сотрудников с зарплатами на уровне middle, основываясь на минимальных и максимальных значениях, которые вводятся пользователем.

    Программа запрашивает у пользователя минимальную и максимальную сумму ежемесячного заработка специалиста уровня middle.

+ **object SalaryIncrease (Задача 3 'h'):**

    Применяет 7% увеличение зарплат для всех сотрудников и выводит список сотрудников с их старыми и новыми зарплатами.

    Расчет производится автоматически.

### Работу программы можно проверить в среде Intellij IDEA(IntelliJ IDEA), запустив object Main в файле scala_new.scala, или запустив файл scala_new.jar:

#### Собранный файл .jar: ```./Scala_intro/scala_new.jar```

Для запуска программы необходимо в командной строке перейти в папку [./Scala_intro/](./Scala_intro/), где лежит файл, и выполнить команду:

```java -jar scala_new.jar```

### Работа программы в терминале отражена на картинке:

![3b-e.png](pictures%2F3b-e.png)
![3f - 3g.png](pictures%2F3f%20-%203g.png)
![3h.png](pictures%2F3h.png)